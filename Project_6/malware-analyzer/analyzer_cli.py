"""
CLI simple para usar el analizador
"""
import argparse
from src.core.analyzer import MalwareAnalyzer


def main():
    parser = argparse.ArgumentParser(description='Malware Analyzer CLI')
    parser.add_argument('--file', '-f', help='Archivo a analizar')
    parser.add_argument('--url', '-u', help='URL a analizar')
    parser.add_argument('--hash', '-s', help='Hash a consultar')
    parser.add_argument('--engine', '-e', help='Motores a usar (coma separada)', default='virustotal')
    args = parser.parse_args()

    analyzer = MalwareAnalyzer()

    engines = args.engine.split(',') if args.engine else None

    if args.file:
        result = analyzer.analyze_file(args.file, engines=engines)
        print(result)
    elif args.url:
        result = analyzer.analyze_url(args.url, engines=engines)
        print(result)
    elif args.hash:
        result = analyzer.analyze_hash(args.hash, engines=engines)
        print(result)
    else:
        parser.print_help()


if __name__ == '__main__':
    main()
