# ğŸ›¡ï¸ Malware Analyzer Pro

**AnÃ¡lisis de seguridad multi-motor para archivos y URLs**

Sistema profesional de anÃ¡lisis de malware con interfaz grÃ¡fica que integra mÃºltiples APIs de ciberseguridad para detectar amenazas en archivos (hasta 4GB) y URLs.

## âœ¨ CaracterÃ­sticas Principales

### ğŸ” **AnÃ¡lisis Multi-Motor**
- **VirusTotal**: 70+ motores antivirus, 10+ sandboxes dinÃ¡micos
- **Hybrid Analysis**: AnÃ¡lisis de comportamiento en entorno virtualizado
- **MetaDefender**: 30+ motores antivirus + anÃ¡lisis de vulnerabilidades
- **AbuseIPDB**: ReputaciÃ³n de IPs maliciosas
- **URLScan.io**: AnÃ¡lisis visual de URLs sospechosas

### ğŸ“¦ **Soporte de Archivos Grandes**
- âœ… AnÃ¡lisis de archivos hasta **4GB**
- âœ… Carga por chunks para archivos grandes (>650MB)
- âœ… CÃ¡lculo automÃ¡tico de hashes (MD5, SHA1, SHA256)
- âœ… Consulta por hash antes de subir (ahorro de tiempo y cuota)

### ğŸ¨ **Interfaz GrÃ¡fica Moderna**
- **Drag & Drop**: Arrastra archivos directamente
- **Vista de resultados en tiempo real**: Progreso detallado
- **Dashboard de amenazas**: VisualizaciÃ³n grÃ¡fica de detecciones
- **Historial de anÃ¡lisis**: BÃºsqueda y exportaciÃ³n
- **Modo oscuro/claro**: Adaptable a preferencias

### ğŸ”’ **Seguridad y Privacidad**
- âœ… Las API keys se almacenan de forma segura (keyring del sistema)
- âœ… No se suben archivos sensibles sin confirmaciÃ³n
- âœ… OpciÃ³n de anÃ¡lisis local de hashes
- âœ… Logs detallados de todas las operaciones

## ğŸ“Š APIs Integradas

| API | Gratuita | LÃ­mite Archivos | CaracterÃ­sticas |
|-----|----------|----------------|-----------------|
| **VirusTotal** | âœ… SÃ­ (500 req/dÃ­a) | 650MB | 70+ AV, sandboxes, YARA |
| **Hybrid Analysis** | âœ… SÃ­ (200 req/dÃ­a) | 100MB | AnÃ¡lisis de comportamiento |
| **MetaDefender** | âœ… SÃ­ (100 req/dÃ­a) | 80MB | 30+ AV, anÃ¡lisis de vulnerabilidades |
| **AbuseIPDB** | âœ… SÃ­ (1000 req/dÃ­a) | N/A (solo IPs) | ReputaciÃ³n de IPs |
| **URLScan.io** | âœ… SÃ­ (ilimitado) | N/A (solo URLs) | Screenshots, DOM, recursos |

### ğŸ¯ Estrategia para Archivos Grandes (>650MB - 4GB)

Para archivos que exceden los lÃ­mites de las APIs:

1. **AnÃ¡lisis por Hash**: Calcula SHA256 y consulta si ya fue analizado
2. **AnÃ¡lisis de Chunks**: Divide el archivo y analiza partes crÃ­ticas
3. **AnÃ¡lisis Local**: IntegraciÃ³n con ClamAV (opcional)
4. **Reporte Combinado**: Agrega resultados de mÃºltiples fuentes

## ğŸš€ InstalaciÃ³n RÃ¡pida

### Requisitos Previos
- Python 3.8 o superior
- 1GB de espacio en disco
- ConexiÃ³n a internet

### Paso 1: Clonar el Repositorio
```bash
git clone https://github.com/jalbraton/Proyectos_personales_.git
cd Proyectos_personales_/Project_6/malware-analyzer
```

### Paso 2: Instalar Dependencias
```bash
pip install -r requirements.txt
```

### Paso 3: Configurar API Keys
```bash
# Ejecutar el configurador de claves
python setup_keys.py
```

NecesitarÃ¡s obtener API keys gratuitas de:
- [VirusTotal](https://www.virustotal.com/gui/my-apikey) (Gratis, registro requerido)
- [Hybrid Analysis](https://www.hybrid-analysis.com/apikeys/info) (Gratis)
- [MetaDefender](https://metadefender.opswat.com/account) (Gratis)
- [AbuseIPDB](https://www.abuseipdb.com/api) (Gratis)
- [URLScan.io](https://urlscan.io/user/signup) (Opcional)

### Paso 4: Lanzar la AplicaciÃ³n
```bash
# Interfaz grÃ¡fica
python gui_app.py

# O usar CLI
python analyzer_cli.py --file archivo.exe
```

## ğŸ’» Uso de la Interfaz GrÃ¡fica

### 1ï¸âƒ£ **Analizar un Archivo**
```
1. Abrir la aplicaciÃ³n
2. Click en "Seleccionar Archivo" o arrastrar archivo
3. Seleccionar motores de anÃ¡lisis (VirusTotal, Hybrid, etc.)
4. Click en "Analizar"
5. Ver resultados en tiempo real
```

### 2ï¸âƒ£ **Analizar una URL**
```
1. Cambiar a pestaÃ±a "URL"
2. Pegar la URL sospechosa
3. Click en "Analizar URL"
4. Ver screenshots y detecciones
```

### 3ï¸âƒ£ **Consultar Hash**
```
1. Cambiar a pestaÃ±a "Hash"
2. Pegar hash MD5/SHA1/SHA256
3. Click en "Buscar"
4. Ver reportes existentes (sin gastar cuota)
```

## ğŸ–¥ï¸ Uso por LÃ­nea de Comandos

### Analizar un Archivo
```bash
# AnÃ¡lisis completo
python analyzer_cli.py --file malware.exe

# Solo VirusTotal
python analyzer_cli.py --file documento.pdf --engine virustotal

# MÃºltiples motores
python analyzer_cli.py --file app.apk --engine virustotal,hybrid,metadefender

# Archivo grande (solo hash)
python analyzer_cli.py --file video_4gb.mkv --hash-only
```

### Analizar una URL
```bash
python analyzer_cli.py --url https://sospechoso.com

# Con screenshot
python analyzer_cli.py --url https://phishing.com --screenshot
```

### Consultar por Hash
```bash
python analyzer_cli.py --hash 5d41402abc4b2a76b9719d911017c592
```

### Analizar IP
```bash
python analyzer_cli.py --ip 185.220.101.34
```

## ğŸ“ Estructura del Proyecto

```
malware-analyzer/
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ engines/               # Integraciones con APIs
â”‚   â”‚   â”œâ”€â”€ virustotal_api.py
â”‚   â”‚   â”œâ”€â”€ hybrid_api.py
â”‚   â”‚   â”œâ”€â”€ metadefender_api.py
â”‚   â”‚   â”œâ”€â”€ abuseipdb_api.py
â”‚   â”‚   â””â”€â”€ urlscan_api.py
â”‚   â”‚
â”‚   â”œâ”€â”€ core/                  # LÃ³gica principal
â”‚   â”‚   â”œâ”€â”€ file_handler.py   # Manejo de archivos grandes
â”‚   â”‚   â”œâ”€â”€ hash_calculator.py
â”‚   â”‚   â”œâ”€â”€ analyzer.py        # Orquestador de anÃ¡lisis
â”‚   â”‚   â””â”€â”€ reporter.py        # GeneraciÃ³n de reportes
â”‚   â”‚
â”‚   â”œâ”€â”€ gui/                   # Interfaz grÃ¡fica
â”‚   â”‚   â”œâ”€â”€ main_window.py
â”‚   â”‚   â”œâ”€â”€ file_tab.py
â”‚   â”‚   â”œâ”€â”€ url_tab.py
â”‚   â”‚   â”œâ”€â”€ history_tab.py
â”‚   â”‚   â””â”€â”€ settings_dialog.py
â”‚   â”‚
â”‚   â””â”€â”€ utils/                 # Utilidades
â”‚       â”œâ”€â”€ config.py
â”‚       â”œâ”€â”€ logger.py
â”‚       â””â”€â”€ keyring_manager.py
â”‚
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ history.db            # Base de datos de historial
â”‚   â””â”€â”€ cache/                # CachÃ© de resultados
â”‚
â”œâ”€â”€ logs/                     # Logs de operaciones
â”œâ”€â”€ reports/                  # Reportes generados
â”œâ”€â”€ tests/                    # Tests unitarios
â”‚
â”œâ”€â”€ gui_app.py               # Entrada GUI
â”œâ”€â”€ analyzer_cli.py          # Entrada CLI
â”œâ”€â”€ setup_keys.py            # Configurador de API keys
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ README.md
â”œâ”€â”€ QUICKSTART.md
â””â”€â”€ LICENSE
```

## ğŸ”§ ConfiguraciÃ³n Avanzada

### LÃ­mites de API
Editar `src/utils/config.py`:

```python
API_LIMITS = {
    'virustotal': {
        'requests_per_day': 500,
        'requests_per_minute': 4,
        'max_file_size': 650 * 1024 * 1024  # 650MB
    },
    'hybrid_analysis': {
        'requests_per_day': 200,
        'max_file_size': 100 * 1024 * 1024  # 100MB
    },
    # ...
}
```

### Habilitar ClamAV Local (Opcional)
Para anÃ¡lisis offline de archivos grandes:

```bash
# Windows (instalar con Chocolatey)
choco install clamav

# Linux
sudo apt-get install clamav clamav-daemon

# macOS
brew install clamav
```

Actualizar `config.py`:
```python
ENABLE_LOCAL_SCAN = True
CLAMAV_PATH = "C:\\Program Files\\ClamAV\\clamscan.exe"  # Windows
```

## ğŸ“Š Reportes Generados

DespuÃ©s de cada anÃ¡lisis, se genera:

1. **Reporte en Consola**: Resumen inmediato
2. **Reporte JSON**: `reports/scan_TIMESTAMP.json`
3. **Reporte HTML**: `reports/scan_TIMESTAMP.html` (con grÃ¡ficos)
4. **Reporte PDF**: `reports/scan_TIMESTAMP.pdf` (opcional, requiere wkhtmltopdf)

### Ejemplo de Reporte JSON
```json
{
  "file": "malware.exe",
  "timestamp": "2025-12-01T15:30:00",
  "file_info": {
    "size": 2048000,
    "md5": "5d41402abc4b2a76b9719d911017c592",
    "sha1": "aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d",
    "sha256": "2c26b46b68ffc68ff99b453c1d30413413422d706..."
  },
  "results": {
    "virustotal": {
      "malicious": 45,
      "suspicious": 5,
      "undetected": 20,
      "threat_label": "Trojan.GenericKD.12345678"
    },
    "hybrid_analysis": {
      "verdict": "malicious",
      "threat_score": 95,
      "malware_family": "Emotet"
    },
    "metadefender": {
      "malicious": 28,
      "clean": 2,
      "verdict": "high_risk"
    }
  },
  "verdict": "MALICIOSO",
  "confidence": 98.5
}
```

## ğŸ§ª Testing

```bash
# Ejecutar todos los tests
python -m pytest tests/

# Tests especÃ­ficos
python -m pytest tests/test_virustotal.py

# Con cobertura
python -m pytest --cov=src tests/
```

## ğŸ” Seguridad y Privacidad

### âš ï¸ Advertencias Importantes

1. **No subir archivos confidenciales**: VirusTotal comparte muestras con investigadores
2. **Datos personales**: Elimina metadatos antes de subir archivos
3. **Archivos privados**: Usa la opciÃ³n "Hash Only" para archivos sensibles
4. **API Keys**: Nunca compartas tus claves, se almacenan en el keyring del sistema

### ğŸ›¡ï¸ Buenas PrÃ¡cticas

- âœ… Usa anÃ¡lisis por hash para archivos sensibles
- âœ… Revisa los reportes antes de tomar decisiones
- âœ… MantÃ©n las API keys seguras
- âœ… Actualiza regularmente las firmas de ClamAV
- âœ… Verifica los resultados con mÃºltiples motores

## ğŸ¤ Contribuir

Â¡Las contribuciones son bienvenidas! Por favor:

1. Fork el repositorio
2. Crea una rama para tu feature (`git checkout -b feature/NuevaAPI`)
3. Commit tus cambios (`git commit -m 'AÃ±adir integraciÃ³n con NuevaAPI'`)
4. Push a la rama (`git push origin feature/NuevaAPI`)
5. Abre un Pull Request

## ğŸ“ Changelog

### v1.0.0 (2025-01-01)
- âœ… IntegraciÃ³n con VirusTotal API v3
- âœ… IntegraciÃ³n con Hybrid Analysis
- âœ… IntegraciÃ³n con MetaDefender
- âœ… IntegraciÃ³n con AbuseIPDB
- âœ… IntegraciÃ³n con URLScan.io
- âœ… Soporte para archivos hasta 4GB
- âœ… Interfaz grÃ¡fica con PyQt5
- âœ… CLI para automatizaciÃ³n
- âœ… AnÃ¡lisis por chunks para archivos grandes
- âœ… Historial de anÃ¡lisis con bÃºsqueda
- âœ… GeneraciÃ³n de reportes HTML/JSON/PDF
- âœ… Almacenamiento seguro de API keys

## â“ FAQ

**P: Â¿Puedo analizar archivos de 4GB con las APIs gratuitas?**  
R: Las APIs tienen lÃ­mites (VirusTotal 650MB, Hybrid 100MB). Para archivos >650MB, el sistema calcula el hash y consulta la base de datos sin subir el archivo. Si no existe, se analiza por chunks o con ClamAV local.

**P: Â¿CuÃ¡ntas peticiones puedo hacer por dÃ­a?**  
R: Con cuentas gratuitas: VirusTotal 500/dÃ­a, Hybrid 200/dÃ­a, MetaDefender 100/dÃ­a, AbuseIPDB 1000/dÃ­a.

**P: Â¿Los resultados se comparten pÃºblicamente?**  
R: VirusTotal comparte muestras con la comunidad. Para archivos sensibles, usa anÃ¡lisis por hash o ClamAV local.

**P: Â¿Funciona offline?**  
R: Parcialmente. Con ClamAV instalado, puedes escanear localmente. Las APIs requieren internet.

**P: Â¿CÃ³mo actualizo las firmas de ClamAV?**  
R: Ejecuta `freshclam` periÃ³dicamente para actualizar las bases de datos de virus.

## ğŸ“„ Licencia

MIT License - Ver [LICENSE](LICENSE) para mÃ¡s detalles.

## ğŸ™ Agradecimientos

- [VirusTotal](https://www.virustotal.com/) por su excelente API
- [Hybrid Analysis](https://www.hybrid-analysis.com/) por el anÃ¡lisis de comportamiento
- [OPSWAT MetaDefender](https://metadefender.opswat.com/) por el anÃ¡lisis multi-motor
- [AbuseIPDB](https://www.abuseipdb.com/) por la base de datos de IPs maliciosas
- [URLScan.io](https://urlscan.io/) por el anÃ¡lisis visual de URLs
- [ClamAV](https://www.clamav.net/) por el motor antivirus open source

## ğŸ“§ Contacto

**JosÃ© Albraton**
- GitHub: [@jalbraton](https://github.com/jalbraton)
- Email: contacto@jalbraton.com

---

âš ï¸ **Disclaimer**: Esta herramienta es solo para fines educativos y de investigaciÃ³n en ciberseguridad. El autor no se responsabiliza del uso indebido de la misma.

ğŸ›¡ï¸ **Stay Safe Online!**
